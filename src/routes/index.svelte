<script lang="ts">
  let email: string
  let username: string
  let isPrivacyAgreed: boolean
  
  const onSubmit = async () => {    
    if (!email) {
      alert("ë‰´ìŠ¤ë ˆí„°ë¥¼ êµ¬ë…í•˜ë ¤ë©´ ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.")

      return
    }
    
    if (!username) {
      alert("ë‰´ìŠ¤ë ˆí„°ë¥¼ êµ¬ë…í•˜ë ¤ë©´ ë³„ëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.")

      return
    }
    
    if (!isPrivacyAgreed) {
      alert("ë‰´ìŠ¤ë ˆí„°ë¥¼ êµ¬ë…í•˜ë ¤ë©´ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•´ ì£¼ì„¸ìš”.")

      return
    }
    
    const res = await fetch("https://api.heytrip.kr/v1/subscribes", {
      method: "POST",
      body: JSON.stringify({
        email,
        username,
        isPrivacyAgreed,
      })
    })

    if (res.status !== 201) {
      alert("ì ì‹œ ì˜¤ë¥˜ê°€ ìƒê²¼ì–´ìš”. ë‹¤ìŒì— ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.")

      return
    }

    alert(`${username}ë‹˜, êµ¬ë…í•´ ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”!`)

    email = ""
    username = ""
  }
</script>

<svelte:head>
	<title>í—¤ì´íŠ¸ë¦½ Heytrip</title>
</svelte:head>

<h1>Heytrip</h1>
<p>ğŸ¥± ëª¨ì²˜ëŸ¼ ìˆëŠ” íœ´ì¼ì„ ë»”í•˜ê²Œ ë³´ë‚´ì§€ ì•Šê³  ë§¤ë²ˆ íŠ¹ë³„í•œ ê²½í—˜ì„ ë‚¨ê¸°ê³  ì‹¶ì€ ì—¬ëŸ¬ë¶„ê»˜.</p>
<p>ğŸ˜« ë‹¤ê°€ì˜¤ëŠ” ì£¼ë§ì—” ë˜ ì–´ë””ë¥¼ ê°€ì•¼ ì¢‹ì„ì§€ ì—¬ê¸°ì €ê¸° ì°¾ì•„ë‹¤ë‹ˆëŠ” ì¼ì´ ê·€ì°®ì€ ì—¬ëŸ¬ë¶„ê»˜.</p>
<p>ğŸ“¨ ë§¤ì£¼ ì§€ê¸ˆì´ ì•„ë‹ˆë©´ ê°ˆ ìˆ˜ ì—†ëŠ” ì¥ì†Œë“¤ì„ ì°¾ì•„ ì„±í–¥ì— ê¼­ ë§ê²Œë” ì¶”ë ¤ ë³´ë‚´ë“œë¦´ê²Œìš”.</p>
<form on:submit|preventDefault={onSubmit}>
  <label>
    ì´ë©”ì¼
    <input type="email" bind:value={email}/>
  </label>
  <label>
    ë³„ëª…
    <input type="text" bind:value={username}/>
  </label>
  <label>
    <input type="checkbox" bind:checked={isPrivacyAgreed}>
    <a href="/privacy">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©</a>ì— ë™ì˜í•©ë‹ˆë‹¤.
  </label>
  <button type="submit">ë¬´ë£Œë¡œ êµ¬ë…í•˜ê¸°</button>
</form>

<style>
	h1 {
		display: flex;
		justify-content: center;
		align-items: center;
		text-align: center;
		font-size: 64px;
		font-family: 'Happiness-Sans-Title';
		height: 92px;
	}

  label {
    margin-top: 16px;
  }

  p + p {
    margin-top: 0px;
  }

  button {
    margin-top: 24px;
  }
</style>
